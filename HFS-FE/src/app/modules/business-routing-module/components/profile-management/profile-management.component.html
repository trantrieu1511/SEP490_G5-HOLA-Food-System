<p-dialog [(visible)]="isVisibleOthersEditProfileDialog" [style]="{ width: '450px' }" header="Profile details"
    [modal]="true" styleClass="p-fluid">
    <ng-template pTemplate="profileInfo">
        <div class="formgrid grid">
            <div class="field col">
                <label for="lastname">Lastname<span style="color: red;">*</span></label>
                <input type="text" pInputText id="lastname" [(ngModel)]="profile.lastName" required />
                <small [style.display]="editProfileValidation.isValidLastName ? 'none !important' : 'block !important'"
                    class="p-error block">{{editProfileValidation.LastNameValidationMessage}}</small>
            </div>
            <div class="field col">
                <label for="firstname">Firstname<span style="color: red;">*</span></label>
                <input type="text" pInputText id="firstname" [(ngModel)]="profile.firstName" required />
                <small [style.display]="editProfileValidation.isValidFirstName ? 'none !important' : 'block !important'"
                    class="p-error block">{{editProfileValidation.FirstNameValidationMessage}}</small>
            </div>
        </div>
        <div class="field">
            <label class="mb-3" for="birthDate">BirthDate</label>
            <input type="date" pInputText id="birthDate" [(ngModel)]="profile.birthDate" />
        </div>
        <div class="field">
            <label class="mb-3">Gender</label>
            <div class="formgrid grid">
                <div class="field-radiobutton col-6">
                    <p-radioButton inputId="male" name="male" value="male" [(ngModel)]="profile.gender"></p-radioButton>
                    <label for="male">Male</label>
                </div>
                <div class="field-radiobutton col-6">
                    <p-radioButton inputId="female" name="female" value="female"
                        [(ngModel)]="profile.gender"></p-radioButton>
                    <label for="female">Female</label>
                </div>
                <div class="field-radiobutton col-6">
                    <p-radioButton inputId="other" name="other" value="other"
                        [(ngModel)]="profile.gender"></p-radioButton>
                    <label for="other">Other</label>
                </div>
            </div>
        </div>
    </ng-template>

    <ng-template pTemplate="footer">
        <button pButton pRipple label="Cancel" icon="pi pi-times" class="p-button-text"
            (click)="this.isVisibleOthersEditProfileDialog = false"></button>
        <button pButton pRipple label="Save" icon="pi pi-check" class="p-button-text" (click)="editProfile()"></button>
    </ng-template>
</p-dialog>

<p-dialog #sellerEditProfileDialog [(visible)]="isVisibleSellerEditProfileDialog" [style]="{ width: '450px' }"
    header="Profile details" [modal]="true" styleClass="p-fluid">
    <ng-template pTemplate="profileInfo">
        <div class="formgrid grid">
            <div class="field col">
                <label for="lastname">Last name<span style="color: red;">*</span></label>
                <input type="text" pInputText id="lastname" [(ngModel)]="profile.lastName" required />
                <small [style.display]="editProfileValidation.isValidLastName ? 'none !important' : 'block !important'"
                    class="p-error block">{{editProfileValidation.LastNameValidationMessage}}</small>
            </div>
            <div class="field col">
                <label for="firstname">First name<span style="color: red;">*</span></label>
                <input type="text" pInputText id="firstname" [(ngModel)]="profile.firstName" required />
                <small [style.display]="editProfileValidation.isValidFirstName ? 'none !important' : 'block !important'"
                    class="p-error block">{{editProfileValidation.FirstNameValidationMessage}}</small>
            </div>
        </div>
        <!-- <div class="formgrid grid"> -->
        <div class="field">
            <label class="mb-3" for="birthDate">Birth date</label>
            <input type="date" pInputText id="birthDate" [(ngModel)]="profile.birthDate" />
        </div>
        <!-- </div> -->

        <div class="field">
            <label class="mb-3">Gender</label>
            <div class="formgrid grid">
                <div class="field-radiobutton col-6">
                    <p-radioButton inputId="male" name="male" value="male" [(ngModel)]="profile.gender"></p-radioButton>
                    <label for="male">Male</label>
                </div>
                <div class="field-radiobutton col-6">
                    <p-radioButton inputId="female" name="female" value="female"
                        [(ngModel)]="profile.gender"></p-radioButton>
                    <label for="female">Female</label>
                </div>
                <div class="field-radiobutton col-6">
                    <p-radioButton inputId="other" name="other" value="other"
                        [(ngModel)]="profile.gender"></p-radioButton>
                    <label for="other">Other</label>
                </div>
            </div>
        </div>

        <div class="field">
            <label for="shopname">Shop name<span style="color: red;">*</span></label>
            <input type="text" pInputText id="shopname" [(ngModel)]="profile.shopName" required />
            <small [style.display]="editProfileValidation.isValidShopName ? 'none !important' : 'block !important'"
                class="p-error block">{{editProfileValidation.ShopNameValidationMessage}}</small>
        </div>
        <div class="field">
            <label for="shopaddress">Shop address<span style="color: red;">*</span></label>
            <textarea class="w-full" rows="5" cols="60" pInputTextarea maxlength="200" id="shopaddress"
                [(ngModel)]="profile.shopAddress" required></textarea>
            <small [style.display]="editProfileValidation.isValidShopAddress ? 'none !important' : 'block !important'"
                class="p-error block">{{editProfileValidation.ShopAddressValidationMessage}}</small>
        </div>
    </ng-template>

    <ng-template pTemplate="footer">
        <button pButton pRipple label="Cancel" icon="pi pi-times" class="p-button-text"
            (click)="this.isVisibleSellerEditProfileDialog = false"></button>
        <button pButton pRipple label="Save" icon="pi pi-check" class="p-button-text" (click)="editProfile()"></button>
    </ng-template>
</p-dialog>

<div class="profilePageContent">
    <div class="card profile-main-body">
        <h2>Manage profile</h2>
        <hr>
        <div class="grid grid-nogutter">
            <div class="col-5 md:col-5" style="margin-left: 3%;">
                <!-- <h5>Avatar</h5> -->
                <img src="{{!isLoggedIn || profileImage.imageBase64 == undefined ? '../../../../../assets/image/user.png' : 'data:image/gif;base64,' + profileImage.imageBase64}}"
                    width="150" height="150" style="border-radius: 50%;" />
                <br><br>
                <!-- <p-button >import img</p-button> -->
                <p-fileUpload [files]="uploadedFiles" mode="basic"
                    [chooseLabel]="profileImage.imageBase64 == undefined ? 'Add profile image':'Edit profile image'"
                    name="demo[]" [showUploadButton]="false" [customUpload]="true" accept="image/*"
                    [maxFileSize]="1000000" (onSelect)="handleFileSelection($event);" [auto]="true"></p-fileUpload>

                <!-- <p-button (onClick)="showUploadedFiles();">Show files uploaded</p-button> -->
            </div>
            <div class="col-6 md:col-6">
                <div style="display: flex;">
                    <p class="field-title">Lastname: </p>
                    <p class="field-info">{{profileDisplay.lastName}}</p>
                </div>
                <hr>
                <div style="display: flex;">
                    <p class="field-title">Firstname: </p>
                    <p class="field-info">{{profileDisplay.firstName}}</p>
                    <!-- Interpolation: Thường được dùng để hiển thị dữ liệu từ file ts lên template. Syntax: {{ expression }} -->
                </div>
                <hr>
                <div style="display: flex;">
                    <p class="field-title">Gender: </p>
                    <p class="field-info">{{profileDisplay.gender}}</p>
                </div>
                <hr>
                <div style="display: flex;">
                    <p class="field-title">BirthDate: </p>
                    <p class="field-info">{{profileDisplay.birthDate}}</p>
                </div>
                <hr>
                <div style="display: flex;">
                    <p class="field-title">Email: </p>
                    <div class="field-info" *ngIf="profileDisplay.email != undefined else RegisterEmail">
                        {{profileDisplay.email}} <i *ngIf="profileDisplay.isVerified" class="pi pi-verified"
                            style="color: green;"></i>
                        <div>
                            <a style="color: #6366F1;" class="edit-email-link" href="#"
                                onClick="event.preventDefault();" (click)="doSomething();">Edit email</a>
                        </div>
                        <div>
                            <a style="color: #6366F1;" class="verify-email-link" href="#"
                                onClick="event.preventDefault();" (click)="doSomething();">Verify email</a>
                        </div>

                    </div>
                    <ng-template #RegisterEmail>
                        <p class="field-info"><p-button [text]="true">Add an email</p-button></p>
                    </ng-template>
                </div>
                <hr>
                <div style="display: flex;">
                    <p class="field-title">Phonenumber: </p>
                    <p class="field-info" *ngIf="profileDisplay.phoneNumber != undefined else RegisterPhoneNumber">
                        {{profileDisplay.phoneNumber}}<p-button [text]="true" (onClick)="editPhoneNumber();">Edit
                            phonenumber</p-button></p>
                    <ng-template #RegisterPhoneNumber>
                        <p class="field-info"><p-button [text]="true" (onclick)="doSomething();">Add a
                                phonenumber</p-button></p>
                    </ng-template>

                    <!-- <a style="width: 50%;">Add a phone number</a> -->
                </div>
                <hr>
                <div *ngIf="this.authService.getRole() == 'SE'">
                    <div style="display: flex;">
                        <p class="field-title">Shop name: </p>
                        <p class="field-info">{{profileDisplay.shopName}} </p>
                    </div>
                    <hr>
                </div>
                <div *ngIf="this.authService.getRole() == 'SE'">
                    <div style="display: flex;">
                        <p class="field-title">Shop address: </p>
                        <p class="field-info">{{profileDisplay.shopAddress}} </p>
                    </div>
                    <hr>
                </div>
                <div *ngIf="this.authService.getRole() == 'SH'">
                    <div style="display: flex;">
                        <p class="field-title">Manage by: </p>
                        <p class="field-info">{{profileDisplay.manageBy}} </p>
                    </div>
                    <hr>
                </div>

                <!-- <div style="display: flex;">
                    <p style="width: 50%;">Walletbalance: </p>
                    <p style="width: 50%;">{{profileDisplay.walletBalance == null ? "0": profileDisplay.walletBalance}}
                    </p>
                </div> -->
                <!-- <hr> -->
                <p-button (click)="openSellerEditProfileDiaglog();"
                    *ngIf="this.authService.getRole() == 'SE' else openOthersEditProfileDialogBtn">Edit</p-button>
                <ng-template #openOthersEditProfileDialogBtn>
                    <p-button (click)="openOthersEditProfileDiaglog();">Edit</p-button>
                </ng-template>


            </div>
        </div>
    </div>
</div>

<p-toast [baseZIndex]="99999" key="notify"></p-toast>